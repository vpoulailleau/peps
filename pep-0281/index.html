
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light dark" />
    <title>PEP 281 – Loop Counter Iteration with range and xrange | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png"/>
    <link rel="canonical" href="https://peps.python.org/pep-0281.html" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/mq.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="css-dark"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg" />
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark" />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <meta name="description" content="Python Enhancement Proposals (PEPs)"/>
</head>
<body>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 281 – Loop Counter Iteration with range and xrange</li>
            </ul>
            <button aria-label="Toggle dark mode" onClick="toggleColourScheme()"></button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 281 – Loop Counter Iteration with range and xrange</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">PEP</dt>
<dd class="field-odd">281</dd>
<dt class="field-even">Title</dt>
<dd class="field-even">Loop Counter Iteration with range and xrange</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd">magnus&#32;&#97;t&#32;hetland.org (Magnus Lie Hetland)</dd>
<dt class="field-even">Status</dt>
<dd class="field-even">Rejected</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd">Standards Track</dd>
<dt class="field-even">Created</dt>
<dd class="field-even">11-Feb-2002</dd>
<dt class="field-odd">Python-Version</dt>
<dd class="field-odd">2.3</dd>
<dt class="field-even">Post-History</dt>
<dd class="field-even"><p></p></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pronouncement">Pronouncement</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#specification">Specification</a></li>
<li><a class="reference internal" href="#alternatives">Alternatives</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract">Abstract</a></h2>
<p>This PEP describes yet another way of exposing the loop counter in
for-loops. It basically proposes that the functionality of the
function <code class="docutils literal notranslate"><span class="pre">indices()</span></code> from <a class="pep reference internal" href="../pep-0212" title="PEP 212 – Loop Counter Iteration">PEP 212</a> be included in the existing
functions <code class="docutils literal notranslate"><span class="pre">range()</span></code> and <code class="docutils literal notranslate"><span class="pre">xrange()</span></code>.</p>
</section>
<section id="pronouncement">
<h2><a class="toc-backref" href="#pronouncement">Pronouncement</a></h2>
<p>In commenting on <a class="pep reference internal" href="../pep-0279" title="PEP 279 – The enumerate() built-in function">PEP 279</a>’s <code class="docutils literal notranslate"><span class="pre">enumerate()</span></code> function, this PEP’s author
offered, “I’m quite happy to have it make <a class="pep reference internal" href="../pep-0281" title="PEP 281 – Loop Counter Iteration with range and xrange">PEP 281</a> obsolete.”
Subsequently, <a class="pep reference internal" href="../pep-0279" title="PEP 279 – The enumerate() built-in function">PEP 279</a> was accepted into Python 2.3.</p>
<p>On 17 June 2005, the BDFL concurred with it being obsolete and
hereby rejected the PEP.  For the record, he found some of the
examples to somewhat jarring in appearance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[5, 7, 9]</span>
</pre></div>
</div>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation">Motivation</a></h2>
<p>It is often desirable to loop over the indices of a sequence.  PEP
212 describes several ways of doing this, including adding a
built-in function called indices, conceptually defined as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">indices</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
</pre></div>
</div>
<p>On the assumption that adding functionality to an existing built-in
function may be less intrusive than adding a new built-in function,
this PEP proposes adding this functionality to the existing
functions <code class="docutils literal notranslate"><span class="pre">range()</span></code> and <code class="docutils literal notranslate"><span class="pre">xrange()</span></code>.</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification">Specification</a></h2>
<p>It is proposed that all three arguments to the built-in functions
<code class="docutils literal notranslate"><span class="pre">range()</span></code> and <code class="docutils literal notranslate"><span class="pre">xrange()</span></code> are allowed to be objects with a length
(i.e. objects implementing the <code class="docutils literal notranslate"><span class="pre">__len__</span></code> method).  If an argument
cannot be interpreted as an integer (i.e. it has no <code class="docutils literal notranslate"><span class="pre">__int__</span></code>
method), its length will be used instead.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">[5, 6, 7, 8, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[5, 7, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>

<span class="go"># Number the lines of a file:</span>
<span class="go">lines = file.readlines()</span>
<span class="go">for num in range(lines):</span>
<span class="go">    print num, lines[num]</span>
</pre></div>
</div>
</section>
<section id="alternatives">
<h2><a class="toc-backref" href="#alternatives">Alternatives</a></h2>
<p>A natural alternative to the above specification is allowing
<code class="docutils literal notranslate"><span class="pre">xrange()</span></code> to access its arguments in a lazy manner.  Thus, instead
of using their length explicitly, <code class="docutils literal notranslate"><span class="pre">xrange</span></code> can return one index for
each element of the stop argument until the end is reached.  A
similar lazy treatment makes little sense for the start and step
arguments since their length must be calculated before iteration
can begin.  (Actually, the length of the step argument isn’t needed
until the second element is returned.)</p>
<p>A pseudo-implementation (using only the stop argument, and assuming
that it is iterable) is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">xrange</span><span class="p">(</span><span class="n">stop</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stop</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Testing whether to use <code class="docutils literal notranslate"><span class="pre">int()</span></code> or lazy iteration could be done by
checking for an <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> attribute.  (This example assumes the
presence of generators, but could easily have been implemented as a
plain iterator object.)</p>
<p>It may be questionable whether this feature is truly useful, since
one would not be able to access the elements of the iterable object
inside the for loop through indexing.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Printing the numbers of the lines of a file:</span>
<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">num</span> <span class="c1"># The line itself is not accessible</span>
</pre></div>
</div>
<p>A more controversial alternative (to deal with this) would be to
let <code class="docutils literal notranslate"><span class="pre">range()</span></code> behave like the function <code class="docutils literal notranslate"><span class="pre">irange()</span></code> of <a class="pep reference internal" href="../pep-0212" title="PEP 212 – Loop Counter Iteration">PEP 212</a> when
supplied with a sequence.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">)</span>
<span class="go">[(0, &#39;a&#39;), (1, &#39;b&#39;), (2, &#39;c&#39;), (3, &#39;d&#39;), (4, &#39;e&#39;)]</span>
</pre></div>
</div>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility">Backwards Compatibility</a></h2>
<p>The proposal could cause backwards incompatibilities if arguments
are used which implement both <code class="docutils literal notranslate"><span class="pre">__int__</span></code> and <code class="docutils literal notranslate"><span class="pre">__len__</span></code> (or <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> in
the case of lazy iteration with <code class="docutils literal notranslate"><span class="pre">xrange</span></code>).  The author does not
believe that this is a significant problem.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/pep-0281.txt">https://github.com/python/peps/blob/main/pep-0281.txt</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/pep-0281.txt">2022-01-21 11:03:51 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <p id="toc-title">PEP 281 – Loop Counter Iteration with range and xrange</p>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pronouncement">Pronouncement</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#specification">Specification</a></li>
<li><a class="reference internal" href="#alternatives">Alternatives</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br />
            <a id="source" href="https://github.com/python/peps/blob/main/pep-0281.txt">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
</body>
</html>