
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light dark" />
    <title>PEP 292 – Simpler String Substitutions | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png"/>
    <link rel="canonical" href="https://peps.python.org/pep-0292.html" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/mq.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="css-dark"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg" />
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark" />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <meta name="description" content="Python Enhancement Proposals (PEPs)"/>
</head>
<body>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 292 – Simpler String Substitutions</li>
            </ul>
            <button aria-label="Toggle dark mode" onClick="toggleColourScheme()"></button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 292 – Simpler String Substitutions</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">PEP</dt>
<dd class="field-odd">292</dd>
<dt class="field-even">Title</dt>
<dd class="field-even">Simpler String Substitutions</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd">barry&#32;&#97;t&#32;python.org (Barry Warsaw)</dd>
<dt class="field-even">Status</dt>
<dd class="field-even">Final</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd">Standards Track</dd>
<dt class="field-even">Created</dt>
<dd class="field-even">18-Jun-2002</dd>
<dt class="field-odd">Python-Version</dt>
<dd class="field-odd">2.4</dd>
<dt class="field-even">Post-History</dt>
<dd class="field-even">18-Jun-2002, 23-Mar-2004, 22-Aug-2004</dd>
<dt class="field-odd">Replaces</dt>
<dd class="field-odd"><a class="reference external" href="../pep-0215">215</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#a-simpler-proposal">A Simpler Proposal</a></li>
<li><a class="reference internal" href="#why-and-braces">Why <code class="docutils literal notranslate"><span class="pre">$</span></code> and Braces?</a></li>
<li><a class="reference internal" href="#comparison-to-pep-215">Comparison to PEP 215</a></li>
<li><a class="reference internal" href="#internationalization">Internationalization</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract">Abstract</a></h2>
<p>This PEP describes a simpler string substitution feature, also
known as string interpolation.  This PEP is “simpler” in two
respects:</p>
<ol class="arabic simple">
<li>Python’s current string substitution feature
(i.e. <code class="docutils literal notranslate"><span class="pre">%</span></code>-substitution) is complicated and error prone.  This PEP
is simpler at the cost of some expressiveness.</li>
<li><a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a> proposed an alternative string interpolation feature,
introducing a new <code class="docutils literal notranslate"><span class="pre">$</span></code> string prefix.  <a class="pep reference internal" href="../pep-0292" title="PEP 292 – Simpler String Substitutions">PEP 292</a> is simpler than
this because it involves no syntax changes and has much simpler
rules for what substitutions can occur in the string.</li>
</ol>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale">Rationale</a></h2>
<p>Python currently supports a string substitution syntax based on
C’s <code class="docutils literal notranslate"><span class="pre">printf()</span></code> ‘<code class="docutils literal notranslate"><span class="pre">%</span></code>’ formatting character <a class="footnote-reference brackets" href="#id4" id="id1">[1]</a>.  While quite rich,
<code class="docutils literal notranslate"><span class="pre">%</span></code>-formatting codes are also error prone, even for
experienced Python programmers.  A common mistake is to leave off
the trailing format character, e.g. the ‘<code class="docutils literal notranslate"><span class="pre">s</span></code>’ in <code class="docutils literal notranslate"><span class="pre">&quot;%(name)s&quot;</span></code>.</p>
<p>In addition, the rules for what can follow a <code class="docutils literal notranslate"><span class="pre">%</span></code> sign are fairly
complex, while the usual application rarely needs such complexity.
Most scripts need to do some string interpolation, but most of
those use simple ‘stringification’ formats, i.e. <code class="docutils literal notranslate"><span class="pre">%s</span></code> or <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code>
This form should be made simpler and less error prone.</p>
</section>
<section id="a-simpler-proposal">
<h2><a class="toc-backref" href="#a-simpler-proposal">A Simpler Proposal</a></h2>
<p>We propose the addition of a new class, called <code class="docutils literal notranslate"><span class="pre">Template</span></code>, which
will live in the string module.  The <code class="docutils literal notranslate"><span class="pre">Template</span></code> class supports new
rules for string substitution; its value contains placeholders,
introduced with the <code class="docutils literal notranslate"><span class="pre">$</span></code> character.  The following rules for
<code class="docutils literal notranslate"><span class="pre">$</span></code>-placeholders apply:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">$$</span></code> is an escape; it is replaced with a single <code class="docutils literal notranslate"><span class="pre">$</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">$identifier</span></code> names a substitution placeholder matching a mapping
key of “identifier”.  By default, “identifier” must spell a
Python identifier as defined in <a class="footnote-reference brackets" href="#id5" id="id2">[2]</a>.  The first non-identifier
character after the <code class="docutils literal notranslate"><span class="pre">$</span></code> character terminates this placeholder
specification.</li>
<li><code class="docutils literal notranslate"><span class="pre">${identifier}</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">$identifier</span></code>.  It is required
when valid identifier characters follow the placeholder but are
not part of the placeholder, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;${noun}ification&quot;</span></code>.</li>
</ol>
<p>If the <code class="docutils literal notranslate"><span class="pre">$</span></code> character appears at the end of the line, or is followed
by any other character than those described above, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>
will be raised at interpolation time.  Values in mapping are
converted automatically to strings.</p>
<p>No other characters have special meaning, however it is possible
to derive from the <code class="docutils literal notranslate"><span class="pre">Template</span></code> class to define different substitution
rules.  For example, a derived class could allow for periods in
the placeholder (e.g. to support a kind of dynamic namespace and
attribute path lookup), or could define a delimiter character
other than <code class="docutils literal notranslate"><span class="pre">$</span></code>.</p>
<p>Once the <code class="docutils literal notranslate"><span class="pre">Template</span></code> has been created, substitutions can be performed
by calling one of two methods:</p>
<ul>
<li><code class="docutils literal notranslate"><span class="pre">substitute()</span></code>.  This method returns a new string which results
when the values of a mapping are substituted for the
placeholders in the <code class="docutils literal notranslate"><span class="pre">Template</span></code>.  If there are placeholders which
are not present in the mapping, a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised.</li>
<li><code class="docutils literal notranslate"><span class="pre">safe_substitute()</span></code>.  This is similar to the <code class="docutils literal notranslate"><span class="pre">substitute()</span></code> method,
except that <code class="docutils literal notranslate"><span class="pre">KeyErrors</span></code> are never raised (due to placeholders
missing from the mapping).  When a placeholder is missing, the
original placeholder will appear in the resulting string.<p>Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from string import Template
&gt;&gt;&gt; s = Template(&#39;${name} was born in ${country}&#39;)
&gt;&gt;&gt; print s.substitute(name=&#39;Guido&#39;, country=&#39;the Netherlands&#39;)
Guido was born in the Netherlands
&gt;&gt;&gt; print s.substitute(name=&#39;Guido&#39;)
Traceback (most recent call last):
[...]
KeyError: &#39;country&#39;
&gt;&gt;&gt; print s.safe_substitute(name=&#39;Guido&#39;)
Guido was born in ${country}
</pre></div>
</div>
</li>
</ul>
<p>The signature of <code class="docutils literal notranslate"><span class="pre">substitute()</span></code> and <code class="docutils literal notranslate"><span class="pre">safe_substitute()</span></code> allows for
passing the mapping of placeholders to values, either as a single
dictionary-like object in the first positional argument, or as
keyword arguments as shown above.  The exact details and
signatures of these two methods is reserved for the standard
library documentation.</p>
</section>
<section id="why-and-braces">
<h2><a class="toc-backref" href="#why-and-braces">Why <code class="docutils literal notranslate"><span class="pre">$</span></code> and Braces?</a></h2>
<p>The BDFL said it best <a class="footnote-reference brackets" href="#id7" id="id3">[4]</a>: “The <code class="docutils literal notranslate"><span class="pre">$</span></code> means “substitution” in so many
languages besides Perl that I wonder where you’ve been. […]
We’re copying this from the shell.”</p>
<p>Thus the substitution rules are chosen because of the similarity
with so many other languages.  This makes the substitution rules
easier to teach, learn, and remember.</p>
</section>
<section id="comparison-to-pep-215">
<h2><a class="toc-backref" href="#comparison-to-pep-215">Comparison to PEP 215</a></h2>
<p><a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a> describes an alternate proposal for string interpolation.
Unlike that PEP, this one does not propose any new syntax for
Python.  All the proposed new features are embodied in a new
library module.  <a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a> proposes a new string prefix
representation such as <code class="docutils literal notranslate"><span class="pre">$&quot;&quot;</span></code> which signal to Python that a new type
of string is present.  <code class="docutils literal notranslate"><span class="pre">$</span></code>-strings would have to interact with the
existing r-prefixes and u-prefixes, essentially doubling the
number of string prefix combinations.</p>
<p><a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a> also allows for arbitrary Python expressions inside the
<code class="docutils literal notranslate"><span class="pre">$</span></code>-strings, so that you could do things like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>import sys
print $&quot;sys = $sys, sys = $sys.modules[&#39;sys&#39;]&quot;
</pre></div>
</div>
<p>which would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;sys&#39;</span> <span class="p">(</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">sys</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;sys&#39;</span> <span class="p">(</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>It’s generally accepted that the rules in <a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a> are safe in the
sense that they introduce no new security issues (see <a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a>,
“Security Issues” for details).  However, the rules are still
quite complex, and make it more difficult to see the substitution
placeholder in the original <code class="docutils literal notranslate"><span class="pre">$</span></code>-string.</p>
<p>The interesting thing is that the <code class="docutils literal notranslate"><span class="pre">Template</span></code> class defined in this
PEP is designed for inheritance and, with a little extra work,
it’s possible to support <a class="pep reference internal" href="../pep-0215" title="PEP 215 – String Interpolation">PEP 215</a>’s functionality using existing
Python syntax.</p>
<p>For example, one could define subclasses of <code class="docutils literal notranslate"><span class="pre">Template</span></code> and dict that
allowed for a more complex placeholder syntax and a mapping that
evaluated those placeholders.</p>
</section>
<section id="internationalization">
<h2><a class="toc-backref" href="#internationalization">Internationalization</a></h2>
<p>The implementation supports internationalization by recording the
original template string in the <code class="docutils literal notranslate"><span class="pre">Template</span></code> instance’s <code class="docutils literal notranslate"><span class="pre">template</span></code>
attribute.  This attribute would serve as the lookup key in an
gettext-based catalog.  It is up to the application to turn the
resulting string back into a <code class="docutils literal notranslate"><span class="pre">Template</span></code> for substitution.</p>
<p>However, the <code class="docutils literal notranslate"><span class="pre">Template</span></code> class was designed to work more intuitively
in an internationalized application, by supporting the mixing-in
of <code class="docutils literal notranslate"><span class="pre">Template</span></code> and unicode subclasses.  Thus an internationalized
application could create an application-specific subclass,
multiply inheriting from <code class="docutils literal notranslate"><span class="pre">Template</span></code> and unicode, and using instances
of that subclass as the gettext catalog key.  Further, the
subclass could alias the special <code class="docutils literal notranslate"><span class="pre">__mod__()</span></code> method to either
<code class="docutils literal notranslate"><span class="pre">.substitute()</span></code> or <code class="docutils literal notranslate"><span class="pre">.safe_substitute()</span></code> to provide a more traditional
string/unicode like <code class="docutils literal notranslate"><span class="pre">%</span></code>-operator substitution syntax.</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation">Reference Implementation</a></h2>
<p>The implementation has been committed to the Python 2.4 source tree.</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#references">References</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id4">[<a href="#id1">1</a>]</dt>
<dd>String Formatting Operations
<a class="reference external" href="http://docs.python.org/library/stdtypes.html#string-formatting-operations">http://docs.python.org/library/stdtypes.html#string-formatting-operations</a></dd>
<dt class="label" id="id5">[<a href="#id2">2</a>]</dt>
<dd>Identifiers and Keywords
<a class="reference external" href="http://docs.python.org/reference/lexical_analysis.html#identifiers-and-keywords">http://docs.python.org/reference/lexical_analysis.html#identifiers-and-keywords</a></dd>
<dt class="label" id="id6">[3]</dt>
<dd>Guido’s python-dev posting from 21-Jul-2002
<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2002-July/026397.html">https://mail.python.org/pipermail/python-dev/2002-July/026397.html</a></dd>
<dt class="label" id="id7">[<a href="#id3">4</a>]</dt>
<dd><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2002-June/025652.html">https://mail.python.org/pipermail/python-dev/2002-June/025652.html</a></dd>
<dt class="label" id="id8">[5]</dt>
<dd>Reference Implementation
<a class="reference external" href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1014055&amp;group_id=5470&amp;atid=305470">http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1014055&amp;group_id=5470&amp;atid=305470</a></dd>
</dl>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/pep-0292.txt">https://github.com/python/peps/blob/main/pep-0292.txt</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/pep-0292.txt">2022-01-21 11:03:51 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <p id="toc-title">PEP 292 – Simpler String Substitutions</p>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#a-simpler-proposal">A Simpler Proposal</a></li>
<li><a class="reference internal" href="#why-and-braces">Why <code class="docutils literal notranslate"><span class="pre">$</span></code> and Braces?</a></li>
<li><a class="reference internal" href="#comparison-to-pep-215">Comparison to PEP 215</a></li>
<li><a class="reference internal" href="#internationalization">Internationalization</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br />
            <a id="source" href="https://github.com/python/peps/blob/main/pep-0292.txt">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
</body>
</html>