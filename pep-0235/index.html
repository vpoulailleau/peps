
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light dark" />
    <title>PEP 235 – Import on Case-Insensitive Platforms | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png"/>
    <link rel="canonical" href="https://peps.python.org/pep-0235.html" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/mq.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="css-dark"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg" />
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark" />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <meta name="description" content="Python Enhancement Proposals (PEPs)"/>
</head>
<body>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 235 – Import on Case-Insensitive Platforms</li>
            </ul>
            <button aria-label="Toggle dark mode" onClick="toggleColourScheme()"></button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 235 – Import on Case-Insensitive Platforms</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">PEP</dt>
<dd class="field-odd">235</dd>
<dt class="field-even">Title</dt>
<dd class="field-even">Import on Case-Insensitive Platforms</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd">Tim Peters &lt;tim.peters&#32;&#97;t&#32;gmail.com&gt;</dd>
<dt class="field-even">Status</dt>
<dd class="field-even">Final</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd">Standards Track</dd>
<dt class="field-even">Created</dt>
<dd class="field-even">21-Feb-2001</dd>
<dt class="field-odd">Python-Version</dt>
<dd class="field-odd">2.1</dd>
<dt class="field-even">Post-History</dt>
<dd class="field-even">16-Feb-2001</dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Contents</summary><ul class="simple">
<li><a class="reference internal" href="#note">Note</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#current-lower-left-semantics">Current Lower-Left Semantics</a></li>
<li><a class="reference internal" href="#proposed-semantics">Proposed Semantics</a></li>
</ul>
</details></section>
<section id="note">
<h2><a class="toc-backref" href="#note">Note</a></h2>
<p>This is essentially a retroactive PEP: the issue came up too late
in the 2.1 release process to solicit wide opinion before deciding
what to do, and can’t be put off until 2.2 without also delaying
the Cygwin and MacOS X ports.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation">Motivation</a></h2>
<p>File systems vary across platforms in whether or not they preserve
the case of filenames, and in whether or not the platform C
library file-opening functions do or don’t insist on
case-sensitive matches:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                     <span class="k">case</span><span class="o">-</span><span class="n">preserving</span>     <span class="n">case</span><span class="o">-</span><span class="n">destroying</span>
                 <span class="o">+-------------------+------------------+</span>
<span class="k">case</span><span class="o">-</span><span class="n">sensitive</span>   <span class="o">|</span> <span class="n">most</span> <span class="n">Unix</span> <span class="n">flavors</span> <span class="o">|</span> <span class="n">brrrrrrrrrr</span>      <span class="o">|</span>
                 <span class="o">+-------------------+------------------+</span>
<span class="k">case</span><span class="o">-</span><span class="n">insensitive</span> <span class="o">|</span> <span class="n">Windows</span>           <span class="o">|</span> <span class="n">some</span> <span class="n">unfortunate</span> <span class="o">|</span>
                 <span class="o">|</span> <span class="n">MacOSX</span> <span class="n">HFS</span><span class="o">+</span>       <span class="o">|</span> <span class="n">network</span> <span class="n">schemes</span>  <span class="o">|</span>
                 <span class="o">|</span> <span class="n">Cygwin</span>            <span class="o">|</span>                  <span class="o">|</span>
                 <span class="o">|</span>                   <span class="o">|</span> <span class="n">OpenVMS</span>          <span class="o">|</span>
                 <span class="o">+-------------------+------------------+</span>
</pre></div>
</div>
<p>In the upper left box, if you create “fiLe” it’s stored as “fiLe”,
and only <code class="docutils literal notranslate"><span class="pre">open(&quot;fiLe&quot;)</span></code> will open it (<code class="docutils literal notranslate"><span class="pre">open(&quot;file&quot;)</span></code> will not, nor
will the 14 other variations on that theme).</p>
<p>In the lower right box, if you create “fiLe”, there’s no telling
what it’s stored as – but most likely as “FILE” – and any of the
16 obvious variations on <code class="docutils literal notranslate"><span class="pre">open(&quot;FilE&quot;)</span></code> will open it.</p>
<p>The lower left box is a mix: creating “fiLe” stores “fiLe” in the
platform directory, but you don’t have to match case when opening
it; any of the 16 obvious variations on <code class="docutils literal notranslate"><span class="pre">open(&quot;FILe&quot;)</span></code> work.</p>
<p>NONE OF THAT IS CHANGING!  Python will continue to follow platform
conventions w.r.t. whether case is preserved when creating a file,
and w.r.t. whether <code class="docutils literal notranslate"><span class="pre">open()</span></code> requires a case-sensitive match.  In
practice, you should always code as if matches were
case-sensitive, else your program won’t be portable.</p>
<p>What’s proposed is to change the semantics of Python “import”
statements, and there <em>only</em> in the lower left box.</p>
</section>
<section id="current-lower-left-semantics">
<h2><a class="toc-backref" href="#current-lower-left-semantics">Current Lower-Left Semantics</a></h2>
<p>Support for MacOSX HFS+, and for Cygwin, is new in 2.1, so nothing
is changing there.  What’s changing is Windows behavior.  Here are
the current rules for import on Windows:</p>
<ol class="arabic">
<li>Despite that the filesystem is case-insensitive, Python insists
on a case-sensitive match.  But not in the way the upper left
box works: if you have two files, <code class="docutils literal notranslate"><span class="pre">FiLe.py</span></code> and <code class="docutils literal notranslate"><span class="pre">file.py</span></code> on
<code class="docutils literal notranslate"><span class="pre">sys.path</span></code>, and do<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">file</span>
</pre></div>
</div>
<p>then if Python finds <code class="docutils literal notranslate"><span class="pre">FiLe.py</span></code> first, it raises a <code class="docutils literal notranslate"><span class="pre">NameError</span></code>.
It does <em>not</em> go on to find <code class="docutils literal notranslate"><span class="pre">file.py</span></code>; indeed, it’s impossible to
import any but the first case-insensitive match on <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>,
and then only if case matches exactly in the first
case-insensitive match.</p>
</li>
<li>An ugly exception: if the first case-insensitive match on
<code class="docutils literal notranslate"><span class="pre">sys.path</span></code> is for a file whose name is entirely in upper case
(<code class="docutils literal notranslate"><span class="pre">FILE.PY</span></code> or <code class="docutils literal notranslate"><span class="pre">FILE.PYC</span></code> or <code class="docutils literal notranslate"><span class="pre">FILE.PYO</span></code>), then the import silently
grabs that, no matter what mixture of case was used in the
import statement.  This is apparently to cater to miserable old
filesystems that really fit in the lower right box.  But this
exception is unique to Windows, for reasons that may or may not
exist.</li>
<li>And another exception: if the environment variable <code class="docutils literal notranslate"><span class="pre">PYTHONCASEOK</span></code>
exists, Python silently grabs the first case-insensitive match
of any kind.</li>
</ol>
<p>So these Windows rules are pretty complicated, and neither match
the Unix rules nor provide semantics natural for the native
filesystem.  That makes them hard to explain to Unix <em>or</em> Windows
users.  Nevertheless, they’ve worked fine for years, and in
isolation there’s no compelling reason to change them.</p>
<p>However, that was before the MacOSX HFS+ and Cygwin ports arrived.
They also have case-preserving case-insensitive filesystems, but
the people doing the ports despised the Windows rules.  Indeed, a
patch to make HFS+ act like Unix for imports got past a reviewer
and into the code base, which incidentally made Cygwin also act
like Unix (but this met the unbounded approval of the Cygwin
folks, so they sure didn’t complain – they had patches of their
own pending to do this, but the reviewer for those balked).</p>
<p>At a higher level, we want to keep Python consistent, by following
the same rules on <em>all</em> platforms with case-preserving
case-insensitive filesystems.</p>
</section>
<section id="proposed-semantics">
<h2><a class="toc-backref" href="#proposed-semantics">Proposed Semantics</a></h2>
<p>The proposed new semantics for the lower left box:</p>
<ol class="upperalpha simple">
<li>If the <code class="docutils literal notranslate"><span class="pre">PYTHONCASEOK</span></code> environment variable exists, same as
before: silently accept the first case-insensitive match of any
kind; raise <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> if none found.</li>
<li>Else search <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> for the first case-sensitive match; raise
<code class="docutils literal notranslate"><span class="pre">ImportError</span></code> if none found.</li>
</ol>
<p>#B is the same rule as is used on Unix, so this will improve cross-
platform portability.  That’s good.  #B is also the rule the Mac
and Cygwin folks want (and wanted enough to implement themselves,
multiple times, which is a powerful argument in PythonLand).  It
can’t cause any existing non-exceptional Windows import to fail,
because any existing non-exceptional Windows import finds a
case-sensitive match first in the path – and it still will.  An
exceptional Windows import currently blows up with a <code class="docutils literal notranslate"><span class="pre">NameError</span></code> or
<code class="docutils literal notranslate"><span class="pre">ImportError</span></code>, in which latter case it still will, or in which
former case will continue searching, and either succeed or blow up
with an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code>.</p>
<p>#A is needed to cater to case-destroying filesystems mounted on Windows,
and <em>may</em> also be used by people so enamored of “natural” Windows
behavior that they’re willing to set an environment variable to
get it.  I don’t intend to implement #A for Unix too, but that’s
just because I’m not clear on how I <em>could</em> do so efficiently (I’m
not going to slow imports under Unix just for theoretical purity).</p>
<p>The potential damage is here: #2 (matching on <code class="docutils literal notranslate"><span class="pre">ALLCAPS.PY</span></code>) is
proposed to be dropped.  Case-destroying filesystems are a
vanishing breed, and support for them is ugly.  We’re already
supporting (and will continue to support) <code class="docutils literal notranslate"><span class="pre">PYTHONCASEOK</span></code> for their
benefit, but they don’t deserve multiple hacks in 2001.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/pep-0235.txt">https://github.com/python/peps/blob/main/pep-0235.txt</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/pep-0235.txt">2022-03-09 16:04:44 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <p id="toc-title">PEP 235 – Import on Case-Insensitive Platforms</p>
            <ul>
<li><a class="reference internal" href="#note">Note</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#current-lower-left-semantics">Current Lower-Left Semantics</a></li>
<li><a class="reference internal" href="#proposed-semantics">Proposed Semantics</a></li>
</ul>

            <br />
            <a id="source" href="https://github.com/python/peps/blob/main/pep-0235.txt">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
</body>
</html>