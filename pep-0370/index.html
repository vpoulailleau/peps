
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light dark" />
    <title>PEP 370 – Per user site-packages directory | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png"/>
    <link rel="canonical" href="https://peps.python.org/pep-0370.html" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/mq.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="css-dark"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg" />
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark" />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <meta name="description" content="Python Enhancement Proposals (PEPs)"/>
</head>
<body>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 370 – Per user site-packages directory</li>
            </ul>
            <button aria-label="Toggle dark mode" onClick="toggleColourScheme()"></button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 370 – Per user site-packages directory</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">PEP</dt>
<dd class="field-odd">370</dd>
<dt class="field-even">Title</dt>
<dd class="field-even">Per user site-packages directory</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd">Christian Heimes &lt;christian&#32;&#97;t&#32;python.org&gt;</dd>
<dt class="field-even">Status</dt>
<dd class="field-even">Final</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd">Standards Track</dd>
<dt class="field-even">Created</dt>
<dd class="field-even">11-Jan-2008</dd>
<dt class="field-odd">Python-Version</dt>
<dd class="field-odd">2.6, 3.0</dd>
<dt class="field-even">Post-History</dt>
<dd class="field-even"><p></p></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#windows-notes">Windows Notes</a></li>
<li><a class="reference internal" href="#unix-notes">Unix Notes</a></li>
<li><a class="reference internal" href="#mac-os-x-notes">Mac OS X Notes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract">Abstract</a></h2>
<p>This PEP proposes a new a per user site-packages directory to allow
users the local installation of Python packages in their home directory.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale">Rationale</a></h2>
<p>Current Python versions don’t have a unified way to install packages
into the home directory of a user (except for Mac Framework
builds). Users are either forced to ask the system administrator to
install or update a package for them or to use one of the many
workarounds like Virtual Python <a class="footnote-reference brackets" href="#id13" id="id1">[1]</a>, Working Env <a class="footnote-reference brackets" href="#id14" id="id2">[2]</a> or
Virtual Env <a class="footnote-reference brackets" href="#id15" id="id3">[3]</a>.</p>
<p>It’s not the goal of the PEP to replace the tools or to implement
isolated installations of Python. It only implements the most common
use case of an additional site-packages directory for each user.</p>
<p>The feature can’t be implemented using the environment variable
<em>PYTHONPATH</em>. The env var just inserts a new directory to the beginning
of <em>sys.path</em> but it doesn’t parse the pth files in the directory. A
full blown site-packages path is required for several applications
and Python eggs.</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification">Specification</a></h2>
<p>site directory (site-packages)</p>
<blockquote>
<div>A directory in <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>. In contrast to ordinary directories the pth
files in the directory are processed, too.</div></blockquote>
<p>user site directory</p>
<blockquote>
<div>A site directory inside the users’ home directory. A user site
directory is specific to a Python version. The path contains
the version number (major and minor only).<dl class="simple">
<dt>Unix (including Mac OS X)</dt><dd><code class="docutils literal notranslate"><span class="pre">~/.local/lib/python2.6/site-packages</span></code></dd>
<dt>Windows</dt><dd><code class="docutils literal notranslate"><span class="pre">%APPDATA%/Python/Python26/site-packages</span></code></dd>
</dl>
</div></blockquote>
<p>user data directory</p>
<blockquote>
<div>Usually the parent directory of the user site directory. It’s meant
for Python version specific data like config files, docs, images
and translations.<dl class="simple">
<dt>Unix (including Mac)</dt><dd><code class="docutils literal notranslate"><span class="pre">~/.local/lib/python2.6</span></code></dd>
<dt>Windows</dt><dd><code class="docutils literal notranslate"><span class="pre">%APPDATA%/Python/Python26</span></code></dd>
</dl>
</div></blockquote>
<p>user base directory</p>
<blockquote>
<div>It’s located inside the user’s home directory. The user site and
use config directory are inside the base directory. On some systems
the directory may be shared with 3rd party apps.<dl class="simple">
<dt>Unix (including Mac)</dt><dd><code class="docutils literal notranslate"><span class="pre">~/.local</span></code></dd>
<dt>Windows</dt><dd><code class="docutils literal notranslate"><span class="pre">%APPDATA%/Python</span></code></dd>
</dl>
</div></blockquote>
<p>user script directory</p>
<blockquote>
<div>A directory for binaries and scripts. <a class="footnote-reference brackets" href="#id22" id="id4">[10]</a> It’s shared across Python
versions and the destination directory for scripts.<dl class="simple">
<dt>Unix (including Mac)</dt><dd><code class="docutils literal notranslate"><span class="pre">~/.local/bin</span></code></dd>
<dt>Windows</dt><dd><code class="docutils literal notranslate"><span class="pre">%APPDATA%/Python/Scripts</span></code></dd>
</dl>
</div></blockquote>
<section id="windows-notes">
<h3><a class="toc-backref" href="#windows-notes">Windows Notes</a></h3>
<p>On Windows the <em>Application Data</em> directory (aka <code class="docutils literal notranslate"><span class="pre">APPDATA</span></code>) was chosen
because it is the most designated place for application data. Microsoft
recommends that software doesn’t write to <code class="docutils literal notranslate"><span class="pre">USERPROFILE</span></code> <a class="footnote-reference brackets" href="#id17" id="id5">[5]</a> and
<code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">Documents</span></code> is not suited for application data, either. <a class="footnote-reference brackets" href="#id20" id="id6">[8]</a> The code
doesn’t query the Win32 API, instead it uses the environment variable
%APPDATA%.</p>
<p>The application data directory is part of the roaming profile. In networks
with domain logins the application data may be copied from and to the a
central server. This can slow down log-in and log-off. Users can keep
the data on the server by e.g. setting PYTHONUSERBASE to the value
“%HOMEDRIVE%%HOMEPATH%Applicata Data”. Users should consult their local
administrator for more information. <a class="footnote-reference brackets" href="#id25" id="id7">[13]</a></p>
</section>
<section id="unix-notes">
<h3><a class="toc-backref" href="#unix-notes">Unix Notes</a></h3>
<p>On Unix <code class="docutils literal notranslate"><span class="pre">~/.local</span></code> was chosen in favor over <code class="docutils literal notranslate"><span class="pre">~/.python</span></code> because the
directory is already used by several other programs in analogy to
<code class="docutils literal notranslate"><span class="pre">/usr/local</span></code>. <a class="footnote-reference brackets" href="#id19" id="id8">[7]</a> <a class="footnote-reference brackets" href="#id23" id="id9">[11]</a></p>
</section>
<section id="mac-os-x-notes">
<h3><a class="toc-backref" href="#mac-os-x-notes">Mac OS X Notes</a></h3>
<p>On Mac OS X Python uses ~/.local directory as well. <a class="footnote-reference brackets" href="#id24" id="id10">[12]</a> Framework builds
of Python include <code class="docutils literal notranslate"><span class="pre">~/Library/Python/2.6/site-packages</span></code> as an additional
search path.</p>
</section>
</section>
<section id="implementation">
<h2><a class="toc-backref" href="#implementation">Implementation</a></h2>
<p>The site module gets a new method <code class="docutils literal notranslate"><span class="pre">adduserpackage()</span></code> which adds the
appropriate directory to the search path. The directory is not added if
it doesn’t exist when Python is started. However the location of the
user site directory and user base directory is stored in an internal
variable for distutils.</p>
<p>The user site directory is added before the system site directories
but after Python’s search paths and <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>. This setup allows
the user to install a different version of a package than the system
administrator but it prevents the user from accidentally overwriting a
stdlib module. Stdlib modules can still be overwritten with
<code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>.</p>
<p>For security reasons the user site directory is <em>not</em> added to
<code class="docutils literal notranslate"><span class="pre">sys.path</span></code> when the effective user id or group id is not equal to the
process uid / gid <a class="footnote-reference brackets" href="#id21" id="id11">[9]</a>. It’s an additional barrier against code injection
into suid apps.  However Python suid scripts <em>must</em> always use the -E
and -s option or users can sneak in their own code.</p>
<p>The user site directory can be suppressed with a new option <code class="docutils literal notranslate"><span class="pre">-s</span></code> or
the environment variable <code class="docutils literal notranslate"><span class="pre">PYTHONNOUSERSITE</span></code>. The feature can be
disabled globally by setting <code class="docutils literal notranslate"><span class="pre">site.ENABLE_USER_SITE</span></code> to the value
<code class="docutils literal notranslate"><span class="pre">False</span></code>. It must be set by editing <code class="docutils literal notranslate"><span class="pre">site.py</span></code>. It can’t be altered
<code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">sitecustomize.py</span></code> or later.</p>
<p>The path to the user base directory can be overwritten with the
environment variable <code class="docutils literal notranslate"><span class="pre">PYTHONUSERBASE</span></code>. The default location is used
when <code class="docutils literal notranslate"><span class="pre">PYTHONUSERBASE</span></code> is not set or empty.</p>
<p><code class="docutils literal notranslate"><span class="pre">distutils.command.install</span></code> (setup.py install) gets a new argument
<code class="docutils literal notranslate"><span class="pre">--user</span></code> to install packages in the user site directory. The required
directories are created on demand.</p>
<p><code class="docutils literal notranslate"><span class="pre">distutils.command.build_ext</span></code> (setup.py build_ext) gets a new argument
<code class="docutils literal notranslate"><span class="pre">--user</span></code> which adds the include/ and lib/ directories in the user base
directory to the search paths for header files and libraries. It also
adds the lib/ directory to rpath.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">site</span></code> module gets two arguments <code class="docutils literal notranslate"><span class="pre">--user-base</span></code> and <code class="docutils literal notranslate"><span class="pre">--user-site</span></code>
to print the path to the user base or user site directory to the standard
output. The feature is intended for scripting, e.g.
<code class="docutils literal notranslate"><span class="pre">./configure</span> <span class="pre">--prefix</span> <span class="pre">$(python2.5</span> <span class="pre">-m</span> <span class="pre">site</span> <span class="pre">--user-base)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">distutils.sysconfig</span></code> will get methods to access the private variables
of site. (not yet implemented)</p>
<p>The Windows updater needs to be updated, too. It should create a menu
item which opens the user site directory in a new explorer windows.</p>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility">Backwards Compatibility</a></h2>
<p>TBD</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation">Reference Implementation</a></h2>
<p>A reference implementation is available in the bug tracker. <a class="footnote-reference brackets" href="#id16" id="id12">[4]</a></p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#references">References</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id13">[<a href="#id1">1</a>]</dt>
<dd>Virtual Python
<a class="reference external" href="http://peak.telecommunity.com/DevCenter/EasyInstall#creating-a-virtual-python">http://peak.telecommunity.com/DevCenter/EasyInstall#creating-a-virtual-python</a></dd>
<dt class="label" id="id14">[<a href="#id2">2</a>]</dt>
<dd>Working Env
<a class="reference external" href="http://pypi.python.org/pypi/workingenv.py">http://pypi.python.org/pypi/workingenv.py</a>
<a class="reference external" href="http://blog.ianbicking.org/workingenv-revisited.html">http://blog.ianbicking.org/workingenv-revisited.html</a></dd>
<dt class="label" id="id15">[<a href="#id3">3</a>]</dt>
<dd>Virtual Env
<a class="reference external" href="http://pypi.python.org/pypi/virtualenv">http://pypi.python.org/pypi/virtualenv</a></dd>
<dt class="label" id="id16">[<a href="#id12">4</a>]</dt>
<dd>reference implementation
<a class="reference external" href="http://bugs.python.org/issue1799">http://bugs.python.org/issue1799</a>
<a class="reference external" href="http://svn.python.org/view/sandbox/trunk/pep370">http://svn.python.org/view/sandbox/trunk/pep370</a></dd>
<dt class="label" id="id17">[<a href="#id5">5</a>]</dt>
<dd>MSDN: CSIDL
<a class="reference external" href="http://msdn2.microsoft.com/en-us/library/bb762494.aspx">http://msdn2.microsoft.com/en-us/library/bb762494.aspx</a></dd>
<dt class="label" id="id18">[6]</dt>
<dd>Initial suggestion for a per user site-packages directory
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/90902">http://permalink.gmane.org/gmane.comp.python.devel/90902</a></dd>
<dt class="label" id="id19">[<a href="#id8">7</a>]</dt>
<dd>Suggestion of ~/.local/
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/90925">http://permalink.gmane.org/gmane.comp.python.devel/90925</a></dd>
<dt class="label" id="id20">[<a href="#id6">8</a>]</dt>
<dd>APPDATA discussion
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/90932">http://permalink.gmane.org/gmane.comp.python.devel/90932</a></dd>
<dt class="label" id="id21">[<a href="#id11">9</a>]</dt>
<dd>Security concerns and -s option
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/91063">http://permalink.gmane.org/gmane.comp.python.devel/91063</a></dd>
<dt class="label" id="id22">[<a href="#id4">10</a>]</dt>
<dd>Discussion about the bin directory
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/91095">http://permalink.gmane.org/gmane.comp.python.devel/91095</a></dd>
<dt class="label" id="id23">[<a href="#id9">11</a>]</dt>
<dd>freedesktop.org XGD basedir specs mentions ~/.local
<a class="reference external" href="http://www.freedesktop.org/wiki/Specifications/basedir-spec">http://www.freedesktop.org/wiki/Specifications/basedir-spec</a></dd>
<dt class="label" id="id24">[<a href="#id10">12</a>]</dt>
<dd>~/.local for Mac and usercustomize file
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/91167">http://permalink.gmane.org/gmane.comp.python.devel/91167</a></dd>
<dt class="label" id="id25">[<a href="#id7">13</a>]</dt>
<dd>Roaming profile on Windows
<a class="reference external" href="http://permalink.gmane.org/gmane.comp.python.devel/91187">http://permalink.gmane.org/gmane.comp.python.devel/91187</a></dd>
</dl>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/pep-0370.txt">https://github.com/python/peps/blob/main/pep-0370.txt</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/pep-0370.txt">2019-07-03 18:20:45 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <p id="toc-title">PEP 370 – Per user site-packages directory</p>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#windows-notes">Windows Notes</a></li>
<li><a class="reference internal" href="#unix-notes">Unix Notes</a></li>
<li><a class="reference internal" href="#mac-os-x-notes">Mac OS X Notes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>

            <br />
            <a id="source" href="https://github.com/python/peps/blob/main/pep-0370.txt">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
</body>
</html>